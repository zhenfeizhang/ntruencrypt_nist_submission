/*
 * ntt.h
 *
 *  Created on: Aug 16, 2017
 *      Author: zhenfei
 */

#ifndef POLY_NTT_H_
#define POLY_NTT_H_

/* roots */
static int64_t roots[1024]= {
        995522,2950373,3017402,3124542,3746196,4539053,4540263,4558175,4746509,4902617,4922169,5520048,5823861,6604961,7043733,8043439,8453082,9438344,9545854,9972872,10883330,11589261,12394667,12563115,12608967,13025653,14365481,15380908,15643072,16466999,17919705,18139446,20684040,21246300,23109017,24623619,26156358,28739422,29579855,31783468,33296321,33789484,35881339,37544515,37634838,38738293,38880484,39030505,39147236,39697507,40011863,40798142,41097699,42296230,44630636,46055807,49409576,52021158,55346844,55988040,56810015,57061070,57347623,58178589,58311971,58838325,60975575,61838424,62781113,63332752,63427071,65635699,65780453,65819687,68178386,68361894,72732138,73158938,73226024,74058168,74160729,77012002,77091250,78093517,78116743,78239663,80031672,80495138,81305150,83481460,84668056,85265961,86109341,87464129,87845680,87849761,88746210,89391791,89449989,90180536,91856231,91994945,93237680,94282750,94482702,95012051,96177548,96798422,100392730,100619697,106612009,107739329,108938984,113272868,113419131,114396708,116085619,116247299,117046558,117119464,118815116,120134677,121573337,121898930,122691872,125486237,125549089,125627414,126279991,126678532,126807914,127109162,129435142,129611435,130833630,131589889,131914486,132063693,132948388,133972090,134514380,135272645,137497397,137698416,138211388,139749603,140474506,140922175,142625073,142807660,142818778,143538205,143852881,143859600,144131003,146446381,147085751,147906133,148277546,148882238,150869650,150920225,150972673,151981605,152412453,153698657,153806391,154279840,154817284,155404505,155407268,158312780,159202644,163640925,165599675,167587201,167839658,168145260,168395414,170894109,171704666,171875939,172912093,173261431,173470286,174253077,176198737,176695169,177393191,179814047,180132826,180523752,180790047,181624325,182294304,185068934,186189086,188270629,189753473,189775158,191775918,192905193,194404127,194435403,196017690,196652009,197322427,197548905,197613601,198846769,199311452,199557733,200171412,200877325,202527382,203252712,203939415,204214475,207706687,208238857,208949954,210506153,212411958,212892217,213290572,214592336,214923180,215456169,216175225,216762086,217539820,217568414,218463684,219440493,220763831,221385427,227212094,228240148,229107745,229174792,231784999,231847182,232383624,232542276,232681679,234795768,235381769,236774093,237185226,237968263,238259378,238289591,239453332,240037774,241756984,242813824,243005499,243174658,243770095,245168496,245408594,245881929,246327558,247709786,248314246,249757247,249947657,250107492,251954855,252173929,252428238,253233151,253647798,256856425,257592784,258539275,260121718,260402737,260447782,265040680,265486316,265832988,266439045,267198093,268690771,269002193,269478940,271394998,272152197,273801826,275765229,278068438,278454853,278922978,280104413,280493808,280689539,281124366,282194399,282754112,283801165,285279178,287513000,289297329,291313573,292226475,292411430,292462858,292756288,292781983,293514926,293876175,295086404,296668706,298289712,299103594,300609510,301835742,308100142,308491097,308693557,310079386,310540357,311320811,312017177,312778576,316532197,316551585,316661819,317796162,321043476,322483102,324508341,324720448,326588916,327687217,331027030,331325468,332804390,333854642,334507178,334887875,335442728,335471307,336160234,336875912,337369724,341847849,342788507,343354607,343445284,344463604,345713886,346916401,347461378,349522209,349838102,354531612,354635179,355700341,359219921,359655242,363257451,364117610,365063599,365547176,367298300,367501695,367656320,367799391,368395236,369971567,371260870,371698009,373016279,374395633,375510067,376495887,376958247,378358467,379392300,381827839,382423558,383140279,383272969,383661620,383693167,383840708,384633841,390433593,390516421,390818677,392026317,392437096,392533473,393017136,393035673,394203685,394783538,399703558,401843982,402344987,403662262,404183385,404236819,404453015,410403596,411005503,411084380,411584773,412060581,412598980,414567562,414739188,415803696,416519049,418313167,420711335,423496283,425070055,425125001,425438550,426422494,427479298,428010545,428309940,428588692,429080837,429530655,430289108,430555175,431041750,433412746,436641827,438538821,438579159,441003711,441805345,444947847,447190307,450084277,450743542,451010295,451584575,452638711,452745431,453250404,453436139,454888878,455073634,458047671,459596657,460812483,461508850,461633002,461795570,461915961,462992669,463525597,463890822,464893599,465473022,467160662,467604541,469997989,470987520,472811541,474710594,475379778,477893940,478466816,478916075,481334941,483823841,486280813,489794001,490003935,490544806,494954670,496398436,496870597,497871950,498626533,500052326,501218913,501412308,501924781,502166255,506324323,507731589,508518151,508692312,509192909,509534829,513140646,513230894,514497475,515873423,517224803,517359985,518241655,518803843,519155304,519599580,522076896,522694786,523648266,524211974,525617292,530830059,532798756,533359991,540390026,540951261,542919958,548132725,549538043,550101751,551055231,551673121,554150437,554594713,554946174,555508362,556390032,556525214,557876594,559252542,560519123,560609371,564215188,564557108,565057705,565231866,566018428,567425694,571583762,571825236,572337709,572531104,573697691,575123484,575878067,576879420,577351581,578795347,583205211,583746082,583956016,587469204,589926176,592415076,594833942,595283201,595856077,598370239,599039423,600938476,602762497,603752028,606145476,606589355,608276995,608856418,609859195,610224420,610757348,611834056,611954447,612117015,612241167,612937534,614153360,615702346,618676383,618861139,620313878,620499613,621004586,621111306,622165442,622739722,623006475,623665740,626559710,628802170,631944672,632746306,635170858,635211196,637108190,640337271,642708267,643194842,643460909,644219362,644669180,645161325,645440077,645739472,646270719,647327523,648311467,648625016,648679962,650253734,653038682,655436850,657230968,657946321,659010829,659182455,661151037,661689436,662165244,662665637,662744514,663346421,669297002,669513198,669566632,670087755,671405030,671906035,674046459,678966479,679546332,680714344,680732881,681216544,681312921,681723700,682931340,683233596,683316424,689116176,689909309,690056850,690088397,690477048,690609738,691326459,691922178,694357717,695391550,696791770,697254130,698239950,699354384,700733738,702052008,702489147,703778450,705354781,705950626,706093697,706248322,706451717,708202841,708686418,709632407,710492566,714094775,714530096,718049676,719114838,719218405,723911915,724227808,726288639,726833616,728036131,729286413,730304733,730395410,730961510,731902168,736380293,736874105,737589783,738278710,738307289,738862142,739242839,739895375,740945627,742424549,742722987,746062800,747161101,749029569,749241676,751266915,752706541,755953855,757088198,757198432,757217820,760971441,761732840,762429206,763209660,763670631,765056460,765258920,765649875,771914275,773140507,774646423,775460305,777081311,778663613,779873842,780235091,780968034,780993729,781287159,781338587,781523542,782436444,784452688,786237017,788470839,789948852,790995905,791555618,792625651,793060478,793256209,793645604,794827039,795295164,795681579,797984788,799948191,801597820,802355019,804271077,804747824,805059246,806551924,807310972,807917029,808263701,808709337,813302235,813347280,813628299,815210742,816157233,816893592,820102219,820516866,821321779,821576088,821795162,823642525,823802360,823992770,825435771,826040231,827422459,827868088,828341423,828581521,829979922,830575359,830744518,830936193,831993033,833712243,834296685,835460426,835490639,835781754,836564791,836975924,838368248,838954249,841068338,841207741,841366393,841902835,841965018,844575225,844642272,845509869,846537923,852364590,852986186,854309524,855286333,856181603,856210197,856987931,857574792,858293848,858826837,859157681,860459445,860857800,861338059,863243864,864800063,865511160,866043330,869535542,869810602,870497305,871222635,872872692,873578605,874192284,874438565,874903248,876136416,876201112,876427590,877098008,877732327,879314614,879345890,880844824,881974099,883974859,883996544,885479388,887560931,888681083,891455713,892125692,892959970,893226265,893617191,893935970,896356826,897054848,897551280,899496940,900279731,900488586,900837924,901874078,902045351,902855908,905354603,905604757,905910359,906162816,908150342,910109092,914547373,915437237,918342749,918345512,918932733,919470177,919943626,920051360,921337564,921768412,922777344,922829792,922880367,924867779,925472471,925843884,926664266,927303636,929619014,929890417,929897136,930211812,930931239,930942357,931124944,932827842,933275511,934000414,935538629,936051601,936252620,938477372,939235637,939777927,940801629,941686324,941835531,942160128,942916387,944138582,944314875,946640855,946942103,947071485,947470026,948122603,948200928,948263780,951058145,951851087,952176680,953615340,954934901,956630553,956703459,957502718,957664398,959353309,960330886,960477149,964811033,966010688,967138008,973130320,973357287,976951595,977572469,978737966,979267315,979467267,980512337,981755072,981893786,983569481,984300028,984358226,985003807,985900256,985904337,986285888,987640676,988484056,989081961,990268557,992444867,993254879,993718345,995510354,995633274,995656500,996658767,996738015,999589288,999691849,1000523993,1000591079,1001017879,1005388123,1005571631,1007930330,1007969564,1008114318,1010322946,1010417265,1010968904,1011911593,1012774442,1014911692,1015438046,1015571428,1016402394,1016688947,1016940002,1017761977,1018403173,1021728859,1024340441,1027694210,1029119381,1031453787,1032652318,1032951875,1033738154,1034052510,1034602781,1034719512,1034869533,1035011724,1036115179,1036205502,1037868678,1039960533,1040453696,1041966549,1044170162,1045010595,1047593659,1049126398,1050641000,1052503717,1053065977,1055610571,1055830312,1057283018,1058106945,1058369109,1059384536,1060724364,1061141050,1061186902,1061355350,1062160756,1062866687,1063777145,1064204163,1064311673,1065296935,1065706578,1066706284,1067145056,1067926156,1068229969,1068827848,1068847400,1069003508,1069191842,1069209754,1069210964,1070003821,1070625475,1070732615,1070799644,1072754495
};


/* inverse of the roots */
static int64_t inv_roots[1024] = {
        835490639, 1070732615, 1070799644, 444947847, 1033738154, 662665637, 383272969, 1005388123, 1065706578, 343445284, 919470177, 623665740, 464893599, 343354607, 29579855, 1069003508, 679546332, 429530655, 83481460, 77012002, 830575359, 17919705, 985904337, 554594713, 214923180, 1041966549, 575123484, 905604757, 335471307, 453250404, 11589261, 418313167, 467160662, 174253077, 425438550, 905910359, 293514926, 926664266, 7043733, 1060724364, 374395633, 142807660, 947071485, 192905193, 973130320, 335442728, 836975924, 349522209, 116085619, 173470286, 1070003821, 44630636, 278454853, 60975575, 40798142, 58838325, 327687217, 564215188, 869810602, 946640855, 757088198, 368395236, 371698009, 126807914, 364117610, 46055807, 42296230, 924867779, 171875939, 403662262, 308491097, 202527382, 267198093, 763209660, 240037774, 1069191842, 390516421, 514497475, 993254879, 154817284, 981755072, 9972872, 371260870, 95012051, 278068438, 775460305, 583746082, 1000523993, 610224420, 9545854, 935538629, 333854642, 180132826, 452638711, 1061355350, 316532197, 131914486, 332804390, 376495887, 936252620, 217539820, 999589288, 148277546, 295086404, 497871950, 78093517, 509192909, 841965018, 828581521, 1036115179, 523648266, 951058145, 150920225, 681216544, 253647798, 252428238, 39147236, 238289591, 920051360, 369971567, 431041750, 788470839, 367799391, 845509869, 966010688, 929897136, 718049676, 334507178, 823642525, 1037868678, 58178589, 1017761977, 470987520, 872872692, 856987931, 359655242, 88746210, 560609371, 663346421, 237185226, 530830059, 620313878, 983569481, 808709337, 989081961, 897551280, 245881929, 151981605, 271394998, 33789484, 908150342, 829979922, 948263780, 179814047, 622739722, 317796162, 1045010595, 813347280, 93237680, 1011911593, 428309940, 108938984, 565231866, 140922175, 892959970, 956703459, 311320811, 1068827848, 74058168, 807917029, 342788507, 438538821, 199557733, 815210742, 930931239, 260121718, 1049126398, 1058369109, 710492566, 765649875, 760971441, 62781113, 281124366, 555508362, 39697507, 21246300, 934000414, 296668706, 618861139, 143859600, 86109341, 474710594, 921337564, 567425694, 747161101, 647327523, 425125001, 334887875, 612241167, 589926176, 635170858, 37544515, 573697691, 347461378, 490544806, 532798756, 428588692, 865511160, 866043330, 384633841, 253233151, 159202644, 556525214, 944138582, 65635699, 204214475, 1018403173, 203252712, 876136416, 876201112, 234795768, 854309524, 472811541, 292756288, 789948852, 299103594, 12608967, 441003711, 478466816, 942916387, 91856231, 232542276, 427479298, 863243864, 577351581, 737589783, 280104413, 951851087, 731902168, 678966479, 976951595, 830936193, 690088397, 217568414, 337369724, 208949954, 587469204, 1034869533, 133972090, 481334941, 1072754495, 116247299, 645739472, 68178386, 399703558, 841902835, 447190307, 1062866687, 930211812, 973357287, 404453015, 140474506, 657230968, 365547176, 606145476, 404183385, 411005503, 947470026, 367501695, 425070055, 114396708, 199311452, 113419131, 719114838, 682931340, 910109092, 167587201, 925843884, 367656320, 936051601, 669513198, 918345512, 781523542, 65780453, 436641827, 565057705, 280689539, 142625073, 475379778, 681312921, 278922978, 78116743, 41097699, 275765229, 227212094, 749241676, 269478940, 172912093, 571825236, 742722987, 860459445, 953615340, 680732881, 292411430, 714530096, 807310972, 289297329, 450743542, 212892217, 696791770, 26156358, 525617292, 94282750, 176695169, 995510354, 214592336, 375510067, 354531612, 902855908, 63427071, 763670631, 765056460, 1007930330, 153806391, 611954447, 902045351, 87849761, 657946321, 1016940002, 146446381, 700733738, 572531104, 793256209, 478916075, 891455713, 49409576, 790995905, 430289108, 89391791, 85265961, 125627414, 188270629, 38738293, 15643072, 852364590, 618676383, 232681679, 844642272, 155407268, 6604961, 4902617, 383840708, 381827839, 611834056, 194435403, 39030505, 411584773, 301835742, 816893592, 948200928, 782436444, 131589889, 905354603, 58311971, 659182455, 247709786, 640337271, 251954855, 260447782, 121573337, 57061070, 117119464, 77091250, 57347623, 752706541, 33296321, 300609510, 89449989, 780968034, 522694786, 451584575, 345713886, 533359991, 494954670, 4540263, 841366393, 566018428, 344463604, 198846769, 429080837, 72732138, 816157233, 557876594, 799948191, 960477149, 786237017, 420711335, 1065296935, 844575225, 241756984, 459596657, 583956016, 63332752, 249757247, 808263701, 245408594, 940801629, 249947657, 1069210964, 349838102, 612117015, 513230894, 708686418, 608276995, 757198432, 827422459, 18139446, 393035673, 576879420, 252173929, 186189086, 23109017, 888681083, 218463684, 834296685, 150869650, 197322427, 390433593, 9438344, 331325468, 571583762, 118815116, 706451717, 268690771, 158312780, 881974099, 215456169, 554946174, 3124542, 243005499, 1068229969, 292462858, 929619014, 379392300, 87464129, 462992669, 16466999, 938477372, 896356826, 736874105, 609859195, 401843982, 551673121, 883996544, 661689436, 761732840, 726833616, 452745431, 992444867, 615702346, 5823861, 659010829, 20684040, 825435771, 572337709, 129435142, 212411958, 180523752, 272152197, 549538043, 216175225, 324720448, 237968263, 883974859, 838368248, 671405030, 993718345, 196017690, 383140279, 852986186, 650253734, 94482702, 1059384536, 879345890, 751266915, 603752028, 791555618, 643194842, 892125692, 690056850, 922777344, 804747824, 96177548, 1021728859, 941686324, 412598980, 73158938, 681723700, 873578605, 554150437, 900488586, 631944672, 1061186902, 556390032, 612937534, 378358467, 106612009, 595856077, 293876175, 134514380, 196652009, 382423558, 691326459, 877098008, 939235637, 779873842, 477893940, 967138008, 695391550, 460812483, 517359985, 12563115, 441805345, 173261431, 519599580, 200171412, 392026317, 1000591079, 661151037, 132063693, 52021158, 977572469, 269002193, 150972673, 383693167, 181624325, 430555175, 282194399, 469997989, 322483102, 194404127, 14365481, 979267315, 423496283, 220763831, 690609738, 877732327, 80031672, 402344987, 235381769, 189775158, 835781754, 749029569, 857574792, 524211974, 801597820, 893226265, 861338059, 944314875, 501412308, 248314246, 1053065977, 414739188, 1067926156, 458047671, 81305150, 621004586, 346916401, 312017177, 412060581, 189753473, 522076896, 671906035, 463890822, 336875912, 177393191, 135272645, 1057283018, 610757348, 986285888, 694357717, 144131003, 781287159, 5520048, 830744518, 1070625475, 518803843, 858293848, 191775918, 915437237, 805059246, 367298300, 954934901, 502166255, 742424549, 1064311673, 683316424, 876427590, 922880367, 239453332, 855286333, 185068934, 1050641000, 887560931, 821576088, 496870597, 680714344, 1055610571, 246327558, 316551585, 465473022, 365063599, 560519123, 461633002, 723911915, 4539053, 823802360, 132948388, 828341423, 265486316, 823992770, 1010417265, 489794001, 614153360, 831993033, 229174792, 8453082, 653038682, 287513000, 113272868, 273801826, 515873423, 257592784, 1001017879, 644669180, 874903248, 729286413, 507731589, 232383624, 1069209754, 578795347, 540390026, 728036131, 622165442, 551055231, 292781983, 984300028, 773140507, 1040453696, 321043476, 1016402394, 996658767, 956630553, 1016688947, 952176680, 813302235, 821795162, 433412746, 826040231, 414567562, 1015438046, 168395414, 942160128, 291313573, 125549089, 256856425, 771914275, 662165244, 1034719512, 879314614, 461915961, 691922178, 689909309, 1068847400, 1067145056, 918342749, 229107745, 841068338, 455073634, 221385427, 1058106945, 1035011724, 885479388, 948122603, 988484056, 984358226, 643460909, 282754112, 1024340441, 182294304, 594833942, 280493808, 501218913, 373016279, 927303636, 56810015, 415803696, 985900256, 171704666, 461795570, 919943626, 65819687, 308693557, 310079386, 1010322946, 170894109, 719218405, 698239950, 859157681, 78239663, 897054848, 979467267, 548132725, 1047593659, 376958247, 860857800, 623006475, 784452688, 266439045, 359219921, 781338587, 393017136, 120134677, 213290572, 331027030, 501924781, 900837924, 804271077, 324508341, 846537923, 797984788, 1032652318, 995633274, 794827039, 392437096, 598370239, 931124944, 793060478, 508692312, 637108190, 1007969564, 292226475, 155404505, 404236819, 137698416, 706093697, 147906133, 906162816, 163640925, 390818677, 354635179, 960330886, 874438565, 959353309, 648679962, 706248322, 126279991, 662744514, 669566632, 467604541, 708202841, 416519049, 933275511, 669297002, 100392730, 143538205, 10883330, 626559710, 231847182, 674046459, 1005571631, 428010545, 957502718, 995522, 592415076, 939777927, 38880484, 486280813, 864800063, 736380293, 856181603, 383661620, 242813824, 96798422, 394783538, 341847849, 121898930, 793645604, 336160234, 496398436, 210506153, 646270719, 841207741, 981893786, 130833630, 595283201, 632746306, 1061141050, 774646423, 283801165, 780993729, 600938476, 219440493, 838954249, 197548905, 197613601, 870497305, 55346844, 869535542, 1008114318, 129611435, 517224803, 914547373, 820516866, 689116176, 207706687, 208238857, 645161325, 540951261, 583205211, 726288639, 500052326, 1036205502, 438579159, 483823841, 461508850, 738862142, 648625016, 426422494, 326588916, 506324323, 152412453, 599039423, 987640676, 929890417, 454888878, 777081311, 139749603, 1052503717, 1034052510, 518241655, 792625651, 1010968904, 312778576, 308100142, 363257451, 15380908, 24623619, 813628299, 142818778, 258539275, 874192284, 635211196, 730961510, 265832988, 999691849, 4922169, 762429206, 117046558, 180790047, 932827842, 508518151, 964811033, 645440077, 61838424, 980512337, 260402737, 28739422, 755953855, 451010295, 893935970, 125486237, 243770095, 165599675, 1039960533, 802355019, 921768412, 827868088, 176198737, 84668056, 265040680, 90180536, 453436139, 542919958, 836564791, 410403596, 513140646, 985003807, 714094775, 216762086, 200877325, 602762497, 55988040, 1015571428, 35881339, 250107492, 739242839, 355700341, 143852881, 107739329, 228240148, 705950626, 285279178, 642708267, 703778450, 153698657, 835460426, 1034602781, 821321779, 820102219, 392533473, 922829792, 122691872, 550101751, 37634838, 245168496, 231784999, 564557108, 995656500, 575878067, 778663613, 925472471, 74160729, 856210197, 137497397, 697254130, 740945627, 941835531, 757217820, 12394667, 621111306, 893617191, 739895375, 138211388, 1064204163, 463525597, 73226024, 490003935, 298289712, 795681579, 978737966, 702489147, 1063777145, 91994945, 918932733, 80495138, 559252542, 683233596, 4558175, 833712243, 310540357, 806551924, 871222635, 765258920, 670087755, 901874078, 148882238, 1031453787, 1027694210, 709632407, 946942103, 702052008, 705354781, 316661819, 127109162, 203939415, 509534829, 746062800, 1014911692, 1032951875, 1012774442, 795295164, 1029119381, 3746196, 900279731, 957664398, 724227808, 236774093, 738307289, 100619697, 880844824, 126678532, 930942357, 699354384, 13025653, 1066706284, 147085751, 780235091, 167839658, 648311467, 899496940, 606589355, 655436850, 1062160756, 620499613, 738278710, 168145260, 498626533, 31783468, 858826837, 519155304, 87845680, 1055830312, 243174658, 996738015, 990268557, 644219362, 394203685, 4746509, 1044170162, 730395410, 608856418, 450084277, 154279840, 730304733, 8043439, 68361894, 690477048, 411084380, 40011863, 628802170, 2950373, 3017402, 238259378
};

/* 1/N mod q */
static int64_t one_over_N = 1072701433;


#endif /* POLY_NTT_H_ */
